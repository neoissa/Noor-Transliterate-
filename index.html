<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noor Transliterate v2 üåü</title>
    <meta name="description"
        content="Free offline Arabic transliteration tool with 99 Names of Allah, Quran search, Arabizi conversion, and virtual keyboard.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&family=Amiri:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#10b981">
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>

<body class="p-3 sm:p-4 md:p-6 lg:p-8 text-slate-800 transition-colors duration-300">

    <!-- PWA Install Banner -->
    <div id="installBanner"
        class="hidden fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-emerald-600 to-teal-600 text-white px-4 py-3 shadow-xl flex items-center justify-between install-slide-down">
        <div class="flex items-center gap-3">
            <span class="text-2xl">üì≤</span>
            <div>
                <p class="font-extrabold text-sm">Install Noor Transliterate</p>
                <p class="text-xs opacity-80">Access offline, anytime</p>
            </div>
        </div>
        <div class="flex gap-2">
            <button onclick="installPWA()"
                class="px-4 py-1.5 bg-white text-emerald-700 rounded-full text-xs font-black">Install</button>
            <button onclick="dismissInstall()"
                class="px-3 py-1.5 text-white/70 hover:text-white text-xs font-bold">Later</button>
        </div>
    </div>

    <div class="max-w-7xl mx-auto relative">

        <!-- Header -->
        <header class="text-center mb-6 pt-4">
            <div class="flex justify-between items-start mb-3">
                <div class="flex items-center gap-2">
                    <button id="darkModeBtn" onclick="toggleDarkMode()"
                        class="w-10 h-10 rounded-full bg-white dark:bg-slate-700 shadow-md flex items-center justify-center text-lg border border-slate-200 dark:border-slate-600 hover:scale-110 transition-transform"
                        title="Toggle Dark Mode (Ctrl+D)">üåô</button>
                    <div class="flex gap-1">
                        <button onclick="setAccentTheme('emerald')"
                            class="w-5 h-5 rounded-full bg-emerald-500 border-2 border-white shadow-sm hover:scale-125 transition-transform accent-dot"
                            title="Emerald"></button>
                        <button onclick="setAccentTheme('blue')"
                            class="w-5 h-5 rounded-full bg-blue-500 border-2 border-white shadow-sm hover:scale-125 transition-transform accent-dot"
                            title="Blue"></button>
                        <button onclick="setAccentTheme('purple')"
                            class="w-5 h-5 rounded-full bg-purple-500 border-2 border-white shadow-sm hover:scale-125 transition-transform accent-dot"
                            title="Purple"></button>
                        <button onclick="setAccentTheme('gold')"
                            class="w-5 h-5 rounded-full bg-amber-500 border-2 border-white shadow-sm hover:scale-125 transition-transform accent-dot"
                            title="Gold"></button>
                    </div>
                </div>
                <div class="flex flex-col items-center">
                    <div
                        class="p-3 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 mb-3">
                        <svg width="44" height="44" viewBox="0 0 100 100" fill="none" class="text-emerald-600">
                            <path d="M50 10L15 25V75L50 90L85 75V25L50 10Z" stroke="currentColor" stroke-width="4"
                                stroke-linejoin="round" fill="white" />
                            <path
                                d="M50 20V80M25 35C25 35 35 40 50 40C65 40 75 35 75 35M25 50C25 50 35 55 50 55C65 55 75 50 75 50M25 65C25 65 35 70 50 70C65 70 75 65 75 65"
                                stroke="currentColor" stroke-width="3" stroke-linecap="round" />
                        </svg>
                    </div>
                    <h1 class="text-3xl sm:text-4xl font-extrabold text-slate-800 dark:text-white tracking-tight">Noor
                        Transliterate <span class="text-emerald-500">v2</span> üåü</h1>
                    <p class="text-slate-500 dark:text-slate-400 mt-1 font-medium italic text-sm">100% Offline
                        Intelligence ‚Ä¢ 99 Names of Allah ‚Ä¢ Quran Search</p>
                    <p class="text-[10px] text-slate-400 dark:text-slate-600 mt-1 font-mono">Press <kbd
                            class="px-1 py-0.5 bg-slate-100 dark:bg-slate-800 rounded text-[9px] font-bold">Ctrl+/</kbd>
                        for shortcuts</p>
                </div>
                <button onclick="toggleHelp()"
                    class="w-10 h-10 rounded-full bg-white dark:bg-slate-700 shadow-md flex items-center justify-center text-lg border border-slate-200 dark:border-slate-600 hover:scale-110 transition-transform"
                    title="Help & Shortcuts">‚ùì</button>
            </div>
        </header>

        <!-- Help Panel -->
        <div id="helpPanel"
            class="hidden mb-6 p-5 rounded-2xl bg-blue-50 dark:bg-slate-800 border border-blue-100 dark:border-slate-600 text-sm text-slate-700 dark:text-slate-300">
            <div class="flex justify-between items-center mb-3">
                <span class="font-black text-blue-800 dark:text-blue-300 uppercase tracking-widest text-xs">‚å®Ô∏è Tips &
                    Shortcuts</span>
                <button onclick="toggleHelp()" class="text-slate-400 hover:text-slate-600">‚úï</button>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs">
                <div>‚Ä¢ <strong>Standard Mode:</strong> Type Arabic ‚Üí get transliteration</div>
                <div>‚Ä¢ <strong>Arabizi Mode:</strong> Type phonetics (e.g. "3rb") ‚Üí get Arabic</div>
                <div>‚Ä¢ <strong>‚ú® Auto-Correct:</strong> Adds proper vowel marks (Harakat)</div>
                <div>‚Ä¢ <strong>üí° Reflection:</strong> Get linguistic root insight for your word</div>
                <div>‚Ä¢ <strong>üìñ Quran Mode:</strong> Search by keyword or ref (e.g. "2:255")</div>
                <div>‚Ä¢ <strong>üì§ Share:</strong> Share Arabic + transliteration instantly</div>
                <div>‚Ä¢ <strong>‚≠ê Save:</strong> Save phrase to History panel below</div>
                <div>‚Ä¢ <strong>Font Slider:</strong> Adjust Arabic output font size</div>
                <div>‚Ä¢ <strong>Try typing:</strong> ar-rahman, al-kareem, bismillah...</div>
                <div>‚Ä¢ <strong>99 Names:</strong> Type any of Allah's names in Arabizi</div>
            </div>
        </div>

        <!-- Daily Ayah Banner -->
        <div id="dailyAyahBanner"
            class="hidden mb-6 glass-morphism dark:glass-dark rounded-3xl p-5 md:p-6 shadow-xl border-l-8 border-emerald-500">
            <div class="flex justify-between items-start mb-3">
                <span
                    class="text-[11px] font-black text-emerald-700 dark:text-emerald-400 uppercase tracking-widest flex items-center gap-2">‚ú®
                    Verse of the Session</span>
                <button onclick="document.getElementById('dailyAyahBanner').classList.add('hidden')"
                    class="text-slate-400 hover:text-slate-600 text-lg leading-none">‚úï</button>
            </div>
            <p id="dailyAyahArabic"
                class="text-2xl sm:text-3xl arabic-text text-right text-emerald-900 dark:text-emerald-300 leading-loose mb-3 font-bold">
            </p>
            <p id="dailyAyahTranslation" class="text-sm text-slate-600 dark:text-slate-400 italic leading-relaxed mb-3">
            </p>
            <div class="flex items-center justify-between flex-wrap gap-2">
                <span id="dailyAyahRef"
                    class="text-xs font-black text-emerald-600 dark:text-emerald-400 uppercase tracking-wider"></span>
                <button onclick="loadAyahIntoTransliterator()"
                    class="px-4 py-2 bg-emerald-600 text-white rounded-full text-xs font-bold hover:bg-emerald-700 transition-all shadow-sm">Load
                    into Transliterator ‚Üí</button>
            </div>
        </div>


        <!-- Mode Toggle -->
        <div class="flex justify-center mb-6">
            <div
                class="inline-flex rounded-2xl shadow-sm bg-white dark:bg-slate-800 p-1.5 border border-slate-200 dark:border-slate-700">
                <button id="modeStandard" onclick="setMode('standard')"
                    class="px-5 sm:px-8 py-2.5 rounded-xl text-xs sm:text-sm font-bold transition-all active-tab">Standard</button>
                <button id="modeArabizi" onclick="setMode('arabizi')"
                    class="px-5 sm:px-8 py-2.5 rounded-xl text-xs sm:text-sm font-bold transition-all text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-700">Arabizi
                    (3rb)</button>
                <button id="modeQuran" onclick="setMode('quran')"
                    class="px-5 sm:px-8 py-2.5 rounded-xl text-xs sm:text-sm font-bold transition-all text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-700 flex items-center gap-1">üìñ
                    Quran</button>
            </div>
        </div>

        <!-- Utility Bar -->
        <div class="flex flex-wrap justify-center gap-3 mb-8">
            <button onclick="autoCorrectText()"
                class="px-4 py-2.5 bg-emerald-600 text-white rounded-full shadow-lg text-xs font-bold hover:bg-emerald-700 transition-all"
                title="Apply Harakat from dictionary">‚ú® Auto-Correct</button>
            <button onclick="localReflectText()"
                class="px-4 py-2.5 bg-white dark:bg-slate-700 border border-blue-200 dark:border-slate-600 text-blue-700 dark:text-blue-300 rounded-full shadow-sm text-xs font-bold hover:bg-blue-50 dark:hover:bg-slate-600 transition-all">üí°
                Reflection</button>
            <button onclick="speakTextNative()"
                class="px-4 py-2.5 bg-slate-800 dark:bg-slate-600 text-white rounded-full shadow-sm text-xs font-bold hover:bg-slate-700 transition-all"
                title="Native browser TTS">üîä Speak</button>
            <button onclick="shareContent()"
                class="px-4 py-2.5 bg-purple-600 text-white rounded-full shadow-sm text-xs font-bold hover:bg-purple-700 transition-all">üì§
                Share</button>
            <button onclick="saveToHistory()"
                class="px-4 py-2.5 bg-amber-500 text-white rounded-full shadow-sm text-xs font-bold hover:bg-amber-600 transition-all">‚≠ê
                Save</button>
            <button onclick="showWordByWord()"
                class="px-4 py-2.5 bg-white dark:bg-slate-700 border border-indigo-200 dark:border-slate-600 text-indigo-700 dark:text-indigo-300 rounded-full shadow-sm text-xs font-bold hover:bg-indigo-50 dark:hover:bg-slate-600 transition-all">üî§
                Word-by-Word</button>
            <button onclick="exportAsImage()"
                class="px-4 py-2.5 bg-white dark:bg-slate-700 border border-amber-200 dark:border-slate-600 text-amber-700 dark:text-amber-300 rounded-full shadow-sm text-xs font-bold hover:bg-amber-50 dark:hover:bg-slate-600 transition-all">üñºÔ∏è
                Export Image</button>
        </div>

        <!-- Loading Indicator -->
        <div id="apiLoading" class="hidden flex justify-center mb-6">
            <div
                class="flex items-center gap-3 bg-white dark:bg-slate-800 px-8 py-4 rounded-2xl shadow-xl border border-slate-100 dark:border-slate-700">
                <div class="loading-spinner"></div>
                <span class="text-sm font-semibold text-slate-600 dark:text-slate-400 italic"
                    id="apiLoadingText">Fetching Data...</span>
            </div>
        </div>

        <div class="space-y-6">

            <!-- Quran Pick UI -->
            <div id="quranPickContainer"
                class="hidden glass-morphism dark:glass-dark rounded-3xl p-6 md:p-8 shadow-xl border-t-8 border-emerald-600 space-y-5">
                <div class="flex items-center gap-3 text-emerald-900 dark:text-emerald-400">
                    <span class="text-2xl">üìñ</span>
                    <span class="text-sm font-extrabold uppercase tracking-widest">Quran Verse Picker</span>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-4 gap-4">
                    <div class="flex flex-col gap-1.5">
                        <label
                            class="text-[11px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-wider ml-1">By
                            Juz</label>
                        <select id="pickJuz" onchange="handleJuzChange()"
                            class="p-3 rounded-xl border border-slate-200 dark:border-slate-600 text-sm bg-white dark:bg-slate-800 dark:text-white outline-none focus:ring-2 focus:ring-emerald-500"></select>
                    </div>
                    <div class="flex flex-col gap-1.5">
                        <label
                            class="text-[11px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-wider ml-1">By
                            Surah</label>
                        <select id="pickSurah" onchange="handleSurahChange()"
                            class="p-3 rounded-xl border border-slate-200 dark:border-slate-600 text-sm bg-white dark:bg-slate-800 dark:text-white outline-none focus:ring-2 focus:ring-emerald-500"></select>
                    </div>
                    <div class="flex flex-col gap-1.5">
                        <label
                            class="text-[11px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-wider ml-1">By
                            Ayah</label>
                        <select id="pickAyah" onchange="handleAyahChange()"
                            class="p-3 rounded-xl border border-slate-200 dark:border-slate-600 text-sm bg-white dark:bg-slate-800 dark:text-white outline-none focus:ring-2 focus:ring-emerald-500"></select>
                    </div>
                    <div class="flex flex-col gap-1.5">
                        <label
                            class="text-[11px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-wider ml-1">Translation</label>
                        <select id="translationLang" onchange="changeTranslationLang()"
                            class="p-3 rounded-xl border border-slate-200 dark:border-slate-600 text-sm bg-white dark:bg-slate-800 dark:text-white outline-none focus:ring-2 focus:ring-emerald-500">
                            <option value="en.sahih">English (Sahih)</option>
                            <option value="en.asad">English (Asad)</option>
                            <option value="ur.jalandhry">Urdu</option>
                            <option value="fr.hamidullah">French</option>
                            <option value="tr.ates">Turkish</option>
                            <option value="fa.makarem">Persian</option>
                            <option value="de.aburida">German</option>
                            <option value="es.cortes">Spanish</option>
                        </select>
                    </div>
                </div>
                <div class="flex gap-3">
                    <input type="text" id="quranKeyword" placeholder="Ref (e.g. '2:255') or keyword..."
                        class="flex-1 p-4 rounded-2xl border border-slate-200 dark:border-slate-600 text-sm outline-none focus:ring-2 focus:ring-emerald-500 shadow-inner bg-white dark:bg-slate-800 dark:text-white"
                        onkeypress="if(event.key==='Enter') handleUnifiedSearch()">
                    <button onclick="handleUnifiedSearch()"
                        class="px-6 py-3 bg-slate-800 dark:bg-emerald-700 text-white rounded-2xl text-sm font-black hover:bg-slate-900 dark:hover:bg-emerald-800 transition-all shadow-md">Search</button>
                </div>
                <div id="quranResults" class="hidden max-h-60 overflow-y-auto space-y-2 pr-1"></div>
            </div>

            <!-- Input + Output Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8">

                <!-- Input Card -->
                <div
                    class="glass-morphism dark:glass-dark rounded-3xl p-6 md:p-8 shadow-xl border-b-8 border-emerald-500 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <label id="inputLabel"
                            class="text-xs sm:text-sm font-black text-slate-700 dark:text-slate-300 uppercase tracking-widest">Input</label>
                        <div class="flex gap-3 items-center">
                            <button onclick="startVoiceInput()" id="voiceBtn"
                                class="text-[11px] font-black text-purple-600 hover:text-purple-700 uppercase"
                                title="Voice Input (Ctrl+M)">üéôÔ∏è Voice</button>
                            <span class="text-slate-300 dark:text-slate-600">|</span>
                            <button onclick="pasteText()"
                                class="text-[11px] font-black text-emerald-600 hover:text-emerald-700 uppercase">üìã
                                Paste</button>
                            <span class="text-slate-300 dark:text-slate-600">|</span>
                            <button onclick="clearText('input')"
                                class="text-[11px] font-black text-red-500 hover:text-red-700 uppercase">Clear</button>
                        </div>
                    </div>
                    <textarea id="mainInput"
                        class="w-full h-44 sm:h-56 p-5 rounded-2xl border border-slate-200 dark:border-slate-600 focus:ring-4 focus:ring-emerald-500/20 outline-none transition-all text-2xl sm:text-3xl shadow-inner bg-white/50 dark:bg-slate-900/50 dark:text-white resize-none"
                        placeholder="Type here..." dir="rtl"></textarea>
                </div>

                <!-- Output Card -->
                <div
                    class="glass-morphism dark:glass-dark rounded-3xl p-6 md:p-8 shadow-xl border-b-8 border-blue-500 flex flex-col space-y-5">

                    <div id="arabicResultSection">
                        <div class="flex justify-between items-center mb-2">
                            <label
                                class="text-[11px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest">Arabic
                                Script</label>
                            <div class="flex items-center gap-3">
                                <div class="flex items-center gap-1.5" title="Arabic font size">
                                    <span class="text-[10px] text-slate-400 font-bold">A</span>
                                    <input type="range" id="fontSizeSlider" min="18" max="52" value="30"
                                        class="w-16 cursor-pointer" oninput="changeFontSize(this.value)">
                                    <span class="text-sm text-slate-400 font-bold">A</span>
                                </div>
                                <button onclick="copyText('outputArabicEditable')"
                                    class="text-[10px] font-black text-emerald-600 hover:underline uppercase">Copy
                                    üìã</button>
                            </div>
                        </div>
                        <textarea id="outputArabicEditable"
                            class="w-full p-4 rounded-2xl bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-600 arabic-text shadow-inner min-h-[110px] rtl dark:text-white"
                            dir="rtl" oninput="updateTranslitFromArabicEdit()"></textarea>
                    </div>

                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label
                                class="text-[11px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest">Transliteration</label>
                            <button onclick="copyText('output1')"
                                class="text-[10px] font-black text-blue-600 hover:underline uppercase">Copy üìã</button>
                        </div>
                        <textarea id="output1"
                            class="w-full p-4 rounded-2xl bg-white/60 dark:bg-slate-900/60 border border-slate-200 dark:border-slate-600 text-lg italic leading-relaxed shadow-inner min-h-[85px] ltr dark:text-white"
                            dir="ltr" placeholder="Phonetic output appears here..."></textarea>
                    </div>

                    <!-- Arabizi Reverse Output -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label
                                class="text-[11px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest">Arabizi
                                (Chat Style)</label>
                            <button onclick="copyText('outputArabizi')"
                                class="text-[10px] font-black text-orange-500 hover:underline uppercase">Copy
                                üìã</button>
                        </div>
                        <textarea id="outputArabizi"
                            class="w-full p-4 rounded-2xl bg-orange-50/60 dark:bg-orange-900/10 border border-orange-200 dark:border-orange-800 text-lg leading-relaxed shadow-inner min-h-[50px] ltr font-mono dark:text-orange-200"
                            dir="ltr" placeholder="Arabizi reverse output..." readonly></textarea>
                    </div>

                    <!-- Tajweed Toggle + Output -->
                    <div>
                        <label class="flex items-center gap-2 cursor-pointer mb-2">
                            <input type="checkbox" id="tajweedToggle" onchange="toggleTajweed()"
                                class="w-4 h-4 accent-emerald-500 cursor-pointer" title="Toggle Tajweed color coding">
                            <span
                                class="text-[11px] font-black text-emerald-600 dark:text-emerald-400 uppercase tracking-widest">Tajweed
                                Color Coding</span>
                        </label>
                        <div id="tajweedOutput"
                            class="hidden w-full p-4 rounded-2xl bg-white dark:bg-slate-900 border border-emerald-200 dark:border-emerald-800 text-2xl sm:text-3xl arabic-text shadow-inner min-h-[80px] rtl leading-loose">
                        </div>
                    </div>

                    <div id="translationContainer" class="hidden">
                        <div class="flex justify-between items-center mb-2">
                            <label
                                class="text-[11px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest">Translation
                                (Public API)</label>
                            <button id="quranAudioBtn" onclick="playQuranAudio()"
                                class="hidden px-3 py-1 bg-emerald-600 text-white rounded-full text-[10px] font-black hover:bg-emerald-700">üîä
                                Listen</button>
                        </div>
                        <div id="outputTranslation"
                            class="w-full p-4 rounded-2xl bg-purple-50 dark:bg-purple-900/20 border border-purple-100 dark:border-purple-800 text-base leading-relaxed text-slate-800 dark:text-slate-200 ltr italic"
                            dir="ltr"></div>
                        <audio id="quranAudioPlayer" class="hidden w-full mt-3" controls></audio>
                    </div>

                    <div id="aiInsightsContainer"
                        class="hidden p-5 rounded-2xl bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 shadow-sm">
                        <div class="flex justify-between items-start mb-3">
                            <span
                                class="text-[11px] font-black text-blue-800 dark:text-blue-300 uppercase tracking-widest">üìö
                                Linguistic Root Insight</span>
                            <button onclick="document.getElementById('aiInsightsContainer').classList.add('hidden')"
                                class="text-blue-400 hover:text-blue-600 text-lg leading-none">‚úï</button>
                        </div>
                        <div id="aiInsightsContent"
                            class="text-sm text-blue-900 dark:text-blue-200 leading-relaxed italic ltr" dir="ltr"></div>
                    </div>

                    <!-- Word-by-Word Breakdown -->
                    <div id="wordByWordContainer"
                        class="hidden p-5 rounded-2xl bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800 shadow-sm">
                        <div class="flex justify-between items-start mb-3">
                            <span
                                class="text-[11px] font-black text-indigo-800 dark:text-indigo-300 uppercase tracking-widest">üî§
                                Word-by-Word Breakdown</span>
                            <button onclick="document.getElementById('wordByWordContainer').classList.add('hidden')"
                                class="text-indigo-400 hover:text-indigo-600 text-lg">‚úï</button>
                        </div>
                        <div id="wordByWordGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 rtl"></div>
                    </div>
                </div>
            </div>

            <!-- Keyboard Section -->
            <div id="keyboardSection"
                class="glass-morphism dark:glass-dark rounded-3xl p-6 md:p-8 shadow-xl border-b-8 border-slate-400 overflow-hidden">
                <div
                    class="flex items-center justify-between mb-5 border-b border-slate-100 dark:border-slate-700 pb-3">
                    <div class="flex items-center gap-3 text-slate-700 dark:text-slate-300">
                        <span class="text-2xl">‚å®Ô∏è</span>
                        <span class="text-sm font-black uppercase tracking-widest">Arabic Virtual Keyboard</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="setKeyboardTheme('white')"
                            class="w-8 h-8 rounded-full bg-white border border-slate-300 shadow-sm hover:scale-110 transition-transform"
                            title="White Theme"></button>
                        <button onclick="setKeyboardTheme('black')"
                            class="w-8 h-8 rounded-full bg-slate-800 shadow-sm hover:scale-110 transition-transform"
                            title="Black Theme"></button>
                    </div>
                </div>
                <div id="keyboardGrid"
                    class="grid grid-cols-6 sm:grid-cols-10 md:grid-cols-12 lg:grid-cols-14 gap-2 p-1"></div>
            </div>

            <!-- Custom Dictionary -->
            <div class="glass-morphism dark:glass-dark rounded-3xl p-6 md:p-8 shadow-xl border-b-8 border-amber-300">
                <div class="flex items-center justify-between mb-5 border-b border-slate-100 dark:border-slate-700 pb-3 cursor-pointer"
                    onclick="toggleCustomDictPanel()">
                    <div class="flex items-center gap-3 text-slate-700 dark:text-slate-300"><span
                            class="text-2xl">üìù</span><span class="text-sm font-black uppercase tracking-widest">My
                            Custom Dictionary</span></div>
                    <span id="customDictArrow" class="text-slate-400 text-lg transition-transform duration-300">‚ñº</span>
                </div>
                <div id="customDictPanel" class="hidden space-y-4">
                    <div class="flex flex-col sm:flex-row gap-3">
                        <input type="text" id="customDictKey" placeholder="Arabizi key (e.g. yasalam)"
                            class="flex-1 p-3 rounded-xl border border-slate-200 dark:border-slate-600 text-sm bg-white dark:bg-slate-800 dark:text-white outline-none focus:ring-2 focus:ring-amber-500">
                        <input type="text" id="customDictValue" placeholder="Arabic value (e.g. Ÿäÿß ÿ≥ŸÑÿßŸÖ)" dir="rtl"
                            class="flex-1 p-3 rounded-xl border border-slate-200 dark:border-slate-600 text-sm bg-white dark:bg-slate-800 dark:text-white outline-none focus:ring-2 focus:ring-amber-500 arabic-text">
                        <button onclick="addCustomDictEntry()"
                            class="px-6 py-3 bg-amber-500 text-white rounded-xl text-sm font-black hover:bg-amber-600 transition-all shadow-md">+
                            Add</button>
                    </div>
                    <div id="customDictList" class="space-y-2 max-h-60 overflow-y-auto pr-1"></div>
                    <p id="customDictEmpty" class="text-sm text-slate-400 italic text-center py-4">No custom entries
                        yet.</p>
                </div>
            </div>

            <!-- History Panel -->
            <div class="glass-morphism dark:glass-dark rounded-3xl p-6 md:p-8 shadow-xl border-b-8 border-amber-400">
                <div
                    class="flex items-center justify-between mb-5 border-b border-slate-100 dark:border-slate-700 pb-3">
                    <div class="flex items-center gap-3 text-slate-700 dark:text-slate-300">
                        <span class="text-2xl">üìú</span>
                        <span class="text-sm font-black uppercase tracking-widest">History & Saved</span>
                    </div>
                    <button onclick="clearAllHistory()"
                        class="text-[10px] font-black text-red-500 hover:text-red-700 uppercase">Clear All</button>
                </div>
                <div id="historyList" class="space-y-3 max-h-72 overflow-y-auto pr-1">
                    <p id="historyEmpty" class="text-center text-slate-400 dark:text-slate-500 text-sm italic py-4">No
                        history yet. Use ‚≠ê Save to store a transliteration.</p>
                </div>
            </div>

        </div>

        <footer class="mt-12 text-center text-slate-400 dark:text-slate-600 text-xs space-y-2 font-medium pb-6">
            <p class="italic">"And We have certainly made the Quran easy for remembrance..." (54:17)</p>
            <p>¬© Noor Transliterate v2 ‚Ä¢ Offline-First PWA ‚Ä¢ Zero Data Collection</p>
        </footer>
    </div>

    <!-- Toast -->
    <div id="toastNotification"
        class="fixed bottom-6 right-6 px-5 py-3 bg-slate-900 dark:bg-emerald-700 text-white rounded-2xl shadow-2xl transform translate-y-[150%] opacity-0 transition-all duration-500 font-bold z-50 pointer-events-none flex items-center gap-2 text-sm">
        <span id="toastMsg">Done!</span>
    </div>

    <!-- Keyboard Shortcuts Modal -->
    <div id="shortcutsModal"
        class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm">
        <div
            class="bg-white dark:bg-slate-800 rounded-3xl p-8 max-w-md w-full mx-4 shadow-2xl border border-slate-200 dark:border-slate-700">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-lg font-extrabold text-slate-800 dark:text-white">‚å®Ô∏è Keyboard Shortcuts</h2>
                <button onclick="toggleShortcutsModal()" class="text-slate-400 hover:text-slate-600 text-2xl">‚úï</button>
            </div>
            <div class="space-y-3 text-sm">
                <div class="flex justify-between"><span class="text-slate-600 dark:text-slate-400">Auto-Correct
                        Harakat</span><kbd
                        class="px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded font-mono text-xs">Ctrl+Enter</kbd>
                </div>
                <div class="flex justify-between"><span class="text-slate-600 dark:text-slate-400">Copy Arabic
                        Output</span><kbd
                        class="px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded font-mono text-xs">Ctrl+Shift+C</kbd>
                </div>
                <div class="flex justify-between"><span class="text-slate-600 dark:text-slate-400">Focus Quran
                        Search</span><kbd
                        class="px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded font-mono text-xs">Ctrl+K</kbd></div>
                <div class="flex justify-between"><span class="text-slate-600 dark:text-slate-400">Toggle Dark
                        Mode</span><kbd
                        class="px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded font-mono text-xs">Ctrl+D</kbd></div>
                <div class="flex justify-between"><span class="text-slate-600 dark:text-slate-400">Voice
                        Input</span><kbd
                        class="px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded font-mono text-xs">Ctrl+M</kbd></div>
                <div class="flex justify-between"><span class="text-slate-600 dark:text-slate-400">Save to
                        History</span><kbd
                        class="px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded font-mono text-xs">Ctrl+S</kbd></div>
                <div class="flex justify-between"><span class="text-slate-600 dark:text-slate-400">Show
                        Shortcuts</span><kbd
                        class="px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded font-mono text-xs">Ctrl+/</kbd></div>
            </div>
        </div>
    </div>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').catch(err => console.log('SW error:', err));
            });
        }
    </script>
    <script src="app.js"></script>
    <script src="app2.js"></script>
</body>

</html>